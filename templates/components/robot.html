{# Robot Component - 3D Spline viewer with lazy loading for faster page load #}
<div
    class="w-full h-[500px] md:h-[600px] lg:h-[700px] relative flex flex-col justify-center items-center overflow-visible -mt-8 md:-mt-24">
    <!-- Spotlight Effect -->
    <div class="absolute -top-40 left-0 md:left-60 md:-top-20 pointer-events-none z-[1] w-full h-full">
        <svg class="animate-spotlight w-[150%] h-[150%] lg:w-[100%]" xmlns="http://www.w3.org/2000/svg"
            viewBox="0 0 3787 2842" fill="none">
            <g filter="url(#filter)">
                <ellipse cx="1924.71" cy="273.501" rx="1924.71" ry="273.501"
                    transform="matrix(-0.822377 -0.568943 -0.568943 0.822377 3631.88 2291.09)" fill="white"
                    fill-opacity="0.21"></ellipse>
            </g>
            <defs>
                <filter id="filter" x="0.860352" y="0.838989" width="3785.16" height="2840.26"
                    filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
                    <feFlood flood-opacity="0" result="BackgroundImageFix"></feFlood>
                    <feBlend mode="normal" in="SourceGraphic" in2="BackgroundImageFix" result="shape"></feBlend>
                    <feGaussianBlur stdDeviation="151" result="effect1_foregroundBlur_1065_8"></feGaussianBlur>
                </filter>
            </defs>
        </svg>
    </div>

    <!-- Spline 3D Scene Container - Lazy loaded -->
    <div class="relative z-10 w-[140%] h-[140%] -ml-[20%] flex items-center justify-center" id="spline-container">
        <div class="w-full h-full transform scale-75 origin-center" id="spline-wrapper">
            <!-- Loading placeholder -->
            <div id="robot-placeholder" class="w-full h-full flex items-center justify-center">
                <div class="text-center text-gray-400">
                    <div
                        class="w-16 h-16 border-4 border-cyan-400/30 border-t-cyan-400 rounded-full animate-spin mx-auto mb-4">
                    </div>
                    <p class="text-sm">Loading 3D Robot...</p>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    @keyframes spotlight {
        0% {
            opacity: 0;
            transform: translate(-50%, -50%) scale(0.5);
        }

        100% {
            opacity: 1;
            transform: translate(-50%, -50%) scale(1);
        }
    }

    .animate-spotlight {
        animation: spotlight 2s ease .75s 1 forwards;
    }
</style>

<script>
    (function() {
        const container = document.getElementById('spline-container');
        const wrapper = document.getElementById('spline-wrapper');
        const placeholder = document.getElementById('robot-placeholder');
        let loaded = false;
        
        function loadSpline() {
            if (loaded) return;
            loaded = true;
            
            // Create spline viewer
            const viewer = document.createElement('spline-viewer');
            viewer.setAttribute('url', 'https://prod.spline.design/kZDDjO5HuC9GJUM2/scene.splinecode');
            viewer.setAttribute('loading-anim-type', 'none');
            viewer.setAttribute('background', 'transparent');
            viewer.style.width = '100%';
            viewer.style.height = '100%';
            
            // Remove placeholder and add viewer
            if (placeholder) placeholder.remove();
            wrapper.appendChild(viewer);
            
            // Remove Spline logo
            const removeLogo = () => {
                const shadow = viewer.shadowRoot;
                if (shadow) {
                    const logo = shadow.querySelector('#logo');
                    if (logo) {
                        logo.remove();
                        return true;
                    }
                }
                return false;
            };
            
            const interval = setInterval(() => {
                if (removeLogo()) clearInterval(interval);
            }, 100);
            setTimeout(() => clearInterval(interval), 10000);
        }
        
        // Lazy load with IntersectionObserver
        if ('IntersectionObserver' in window) {
            const observer = new IntersectionObserver((entries) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        loadSpline();
                        observer.disconnect();
                    }
                });
            }, { rootMargin: '100px' });
            observer.observe(container);
        } else {
            // Fallback: load after short delay
            setTimeout(loadSpline, 1000);
        }
    })();
</script>